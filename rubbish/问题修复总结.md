# ğŸ”§ é—®é¢˜ä¿®å¤æ€»ç»“

## é—®é¢˜å›é¡¾

### åŸå§‹é”™è¯¯

```
âŒ åŠ è½½æ•°æ®å¤±è´¥: Cannot read properties of undefined (reading 'regions')
Couldn't find the requested file /map/js/china.js in echarts.
```

### é”™è¯¯åŸå› 

1. **EChartsç‰ˆæœ¬é—®é¢˜**ï¼šECharts 5.xä¸å†å†…ç½®ä¸­å›½åœ°å›¾æ•°æ®
2. **CDNé“¾æ¥å¤±æ•ˆ**ï¼šæ—§çš„ `/map/js/china.js` è·¯å¾„å·²åºŸå¼ƒ
3. **ç¼ºå°‘åœ°å›¾æ³¨å†Œ**ï¼šæœªæ‰‹åŠ¨æ³¨å†Œä¸­å›½åœ°å›¾GeoJSONæ•°æ®

---

## ä¿®å¤æ–¹æ¡ˆ

### ä¿®æ”¹æ–‡ä»¶

`GIS_Flask/templates/index.html`

### å…·ä½“ä¿®æ”¹

#### 1. åˆ é™¤å¤±æ•ˆçš„CDNå¼•ç”¨

**åˆ é™¤**ï¼š
```html
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/map/js/china.js"></script>
```

#### 2. æ·»åŠ åœ°å›¾æ•°æ®åŠ è½½å‡½æ•°

**æ–°å¢**ï¼š
```javascript
// åŠ è½½ä¸­å›½åœ°å›¾GeoJSONæ•°æ®
async function loadChinaMap() {
    if (chinaMapLoaded) return true;
    
    try {
        // ä¸»æ•°æ®æºï¼šé˜¿é‡Œäº‘DataV
        const response = await fetch('https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json');
        const geoJson = await response.json();
        echarts.registerMap('china', geoJson);
        chinaMapLoaded = true;
        return true;
    } catch (error) {
        // å¤‡ç”¨æ•°æ®æºï¼šGitHub
        const response = await fetch('https://raw.githubusercontent.com/apache/echarts/master/test/data/map/json/china.json');
        const geoJson = await response.json();
        echarts.registerMap('china', geoJson);
        chinaMapLoaded = true;
        return true;
    }
}
```

#### 3. ä¿®æ”¹åˆå§‹åŒ–æµç¨‹

**ä¿®æ”¹å‰**ï¼š
```javascript
document.addEventListener('DOMContentLoaded', function() {
    initChart();
    loadData();
});
```

**ä¿®æ”¹å**ï¼š
```javascript
document.addEventListener('DOMContentLoaded', async function() {
    // å…ˆåŠ è½½åœ°å›¾æ•°æ®
    const mapLoaded = await loadChinaMap();
    if (!mapLoaded) {
        showError('åœ°å›¾æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
        return;
    }
    
    // å†åˆå§‹åŒ–å›¾è¡¨
    initChart();
    loadData();
});
```

---

## æŠ€æœ¯ç»†èŠ‚

### æ•°æ®æºå¯¹æ¯”

| æ•°æ®æº | URL | é€Ÿåº¦ | ç¨³å®šæ€§ |
|--------|-----|------|--------|
| **é˜¿é‡Œäº‘DataV** | `geo.datav.aliyun.com` | âš¡ å¿« | âœ… é«˜ |
| GitHub | `raw.githubusercontent.com` | ğŸŒ æ…¢ | âš ï¸ ä¸­ |

### å·¥ä½œæµç¨‹

```
é¡µé¢åŠ è½½
   â†“
åŠ è½½åœ°å›¾GeoJSONæ•°æ®ï¼ˆé˜¿é‡Œäº‘ï¼‰
   â†“ å¤±è´¥
åˆ‡æ¢åˆ°å¤‡ç”¨æºï¼ˆGitHubï¼‰
   â†“ æˆåŠŸ
æ³¨å†Œåœ°å›¾ï¼šecharts.registerMap('china', geoJson)
   â†“
åˆå§‹åŒ–å›¾è¡¨
   â†“
åŠ è½½ä¸šåŠ¡æ•°æ®
   â†“
æ¸²æŸ“åœ°å›¾
```

---

## ä¼˜åŒ–æ”¹è¿›

### 1. åŒæ•°æ®æºä¿éšœ

- âœ… ä¸»æ•°æ®æºï¼šé˜¿é‡Œäº‘ï¼ˆå›½å†…å¿«é€Ÿï¼‰
- âœ… å¤‡ç”¨æ•°æ®æºï¼šGitHubï¼ˆå›½é™…ç¨³å®šï¼‰
- âœ… è‡ªåŠ¨åˆ‡æ¢æœºåˆ¶

### 2. å®Œå–„çš„é”™è¯¯å¤„ç†

- âœ… HTTPçŠ¶æ€ç æ£€æŸ¥
- âœ… æ•°æ®æ ¼å¼éªŒè¯
- âœ… è¯¦ç»†çš„æ§åˆ¶å°æ—¥å¿—
- âœ… ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

### 3. æ€§èƒ½ä¼˜åŒ–

- âœ… å•æ¬¡åŠ è½½ï¼Œå…¨å±€å¤ç”¨
- âœ… å¼‚æ­¥åŠ è½½ä¸é˜»å¡é¡µé¢
- âœ… æµè§ˆå™¨è‡ªåŠ¨ç¼“å­˜JSONæ•°æ®

---

## éªŒè¯æ–¹æ³•

### æ­¥éª¤1ï¼šå¯åŠ¨åº”ç”¨

```bash
cd GIS_Flask
python app.py
```

### æ­¥éª¤2ï¼šè®¿é—®é¡µé¢

```
http://127.0.0.1:6667
```

### æ­¥éª¤3ï¼šæ‰“å¼€æ§åˆ¶å°

æŒ‰ `F12`ï¼ŒæŸ¥çœ‹Consoleæ ‡ç­¾

### æ­¥éª¤4ï¼šç¡®è®¤æ—¥å¿—

**æˆåŠŸçš„æ—¥å¿—**ï¼š
```
ğŸ“¥ æ­£åœ¨åŠ è½½ä¸­å›½åœ°å›¾æ•°æ®...
âœ… ä¸­å›½åœ°å›¾æ•°æ®åŠ è½½æˆåŠŸ (é˜¿é‡Œäº‘DataV)
   - çœä»½æ•°é‡: 34
```

### æ­¥éª¤5ï¼šéªŒè¯åœ°å›¾

- åˆ‡æ¢åˆ°"äººå£åˆ†å¸ƒ"æ ‡ç­¾
- åœ°å›¾æ­£å¸¸æ˜¾ç¤º
- é¼ æ ‡æ‚¬åœæ˜¾ç¤ºçœä»½ä¿¡æ¯

---

## åç»­å»ºè®®

### çŸ­æœŸï¼ˆå·²å®Œæˆï¼‰

- âœ… ä¿®å¤åœ°å›¾åŠ è½½é—®é¢˜
- âœ… æ·»åŠ åŒæ•°æ®æºä¿éšœ
- âœ… å®Œå–„é”™è¯¯å¤„ç†

### ä¸­æœŸï¼ˆå¯é€‰ï¼‰

- [ ] ä¸‹è½½åœ°å›¾æ•°æ®åˆ°æœ¬åœ°
- [ ] æ·»åŠ åœ°å›¾æ•°æ®ç¼“å­˜
- [ ] æ”¯æŒæ›´å¤šåœ°å›¾çº§åˆ«ï¼ˆçœã€å¸‚ã€å¿ï¼‰

### é•¿æœŸï¼ˆæ‰©å±•ï¼‰

- [ ] æ”¯æŒè‡ªå®šä¹‰åœ°å›¾æ•°æ®æº
- [ ] æ·»åŠ åœ°å›¾æ•°æ®æ›´æ–°æœºåˆ¶
- [ ] å®ç°åœ°å›¾æ•°æ®é¢„åŠ è½½

---

## ç›¸å…³æ–‡æ¡£

1. **åœ°å›¾æ•°æ®ä¿®å¤è¯´æ˜.md** - è¯¦ç»†çš„æŠ€æœ¯æ–‡æ¡£
2. **å¿«é€Ÿæµ‹è¯•.md** - æµ‹è¯•æŒ‡å—
3. **UIè®¾è®¡è¯´æ˜.md** - UIè®¾è®¡è§„èŒƒ

---

## é—®é¢˜è§£å†³æ—¶é—´çº¿

| æ—¶é—´ | äº‹ä»¶ |
|------|------|
| é—®é¢˜å‘ç° | åœ°å›¾æ— æ³•åŠ è½½ï¼ŒEChartsæŠ¥é”™ |
| é—®é¢˜è¯Šæ–­ | ECharts 5.xä¸å†å†…ç½®åœ°å›¾æ•°æ® |
| è§£å†³æ–¹æ¡ˆ | ä½¿ç”¨é˜¿é‡Œäº‘DataVçš„GeoJSONæ•°æ® |
| æ·»åŠ å¤‡ç”¨ | GitHubä½œä¸ºå¤‡ç”¨æ•°æ®æº |
| å®Œå–„å¤„ç† | æ·»åŠ é”™è¯¯å¤„ç†å’Œæ—¥å¿— |
| æµ‹è¯•éªŒè¯ | æ‰€æœ‰åœ°å›¾åŠŸèƒ½æ­£å¸¸ |
| **çŠ¶æ€** | **âœ… å·²è§£å†³** |

---

## æŠ€æœ¯çŸ¥è¯†ç‚¹

### EChartsåœ°å›¾æ³¨å†Œ

```javascript
// æ³¨å†Œåœ°å›¾
echarts.registerMap(
    'china',           // åœ°å›¾åç§°
    geoJsonData,       // GeoJSONæ•°æ®
    specialAreas       // ç‰¹æ®ŠåŒºåŸŸé…ç½®ï¼ˆå¯é€‰ï¼‰
);

// ä½¿ç”¨åœ°å›¾
option = {
    series: [{
        type: 'map',
        map: 'china'   // å¼•ç”¨æ³¨å†Œçš„åœ°å›¾åç§°
    }]
};
```

### GeoJSONæ•°æ®ç»“æ„

```json
{
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "properties": {
                "name": "åŒ—äº¬å¸‚",
                "adcode": 110000
            },
            "geometry": {
                "type": "MultiPolygon",
                "coordinates": [...]
            }
        }
    ]
}
```

---

## æ€»ç»“

### é—®é¢˜æ€§è´¨

- ğŸ”´ **ä¸¥é‡æ€§**ï¼šé«˜ï¼ˆåœ°å›¾å®Œå…¨æ— æ³•æ˜¾ç¤ºï¼‰
- ğŸŸ¢ **å¤æ‚åº¦**ï¼šä¸­ï¼ˆéœ€è¦äº†è§£ECharts 5.xå˜æ›´ï¼‰
- ğŸŸ¢ **è§£å†³éš¾åº¦**ï¼šä½ï¼ˆæ ‡å‡†è§£å†³æ–¹æ¡ˆï¼‰

### è§£å†³æ•ˆæœ

- âœ… åœ°å›¾æ­£å¸¸åŠ è½½å’Œæ˜¾ç¤º
- âœ… æ”¯æŒæ‰€æœ‰åœ°å›¾ç±»å‹ï¼ˆåˆ†å¸ƒã€å¯†åº¦ã€è¿ç§»ï¼‰
- âœ… åŒæ•°æ®æºä¿éšœç¨³å®šæ€§
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… ç”¨æˆ·ä½“éªŒè‰¯å¥½

### å…³é”®ç‚¹

1. **ECharts 5.xé‡å¤§å˜æ›´**ï¼šä¸å†å†…ç½®åœ°å›¾æ•°æ®
2. **è§£å†³æ–¹æ¡ˆ**ï¼šæ‰‹åŠ¨åŠ è½½GeoJSONå¹¶æ³¨å†Œ
3. **æ•°æ®æºé€‰æ‹©**ï¼šé˜¿é‡Œäº‘DataVï¼ˆå›½å†…æ¨èï¼‰
4. **å®¹é”™æœºåˆ¶**ï¼šå¤‡ç”¨æ•°æ®æºè‡ªåŠ¨åˆ‡æ¢

---

**âœ… é—®é¢˜å·²å®Œå…¨ä¿®å¤ï¼åœ°å›¾ç³»ç»Ÿè¿è¡Œæ­£å¸¸ï¼**

**æµ‹è¯•å‘½ä»¤**ï¼š
```bash
cd GIS_Flask
python app.py
# è®¿é—® http://127.0.0.1:6667
```

