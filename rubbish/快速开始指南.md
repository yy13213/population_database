# ⚡ 内存数据库快速开始指南

## 🎯 3步启动

### 步骤1: 创建内存表（1分钟）

**使用数据库客户端执行**：

```sql
-- 复制 create_memory_tables.sql 的内容并执行
```

或使用命令行：

```bash

```

### 步骤2: 同步数据（2-3分钟）

```bash
cd memory_db
pip install -r requirements.txt
python sync_to_memory.py
```

**等待输出**：
```
✅ 成功: 3/3 个表
📦 总记录数: 13,833,437 条
⏱️  总耗时: 126.85 秒
```

### 步骤3: 修改GIS系统使用内存表

编辑 `GIS_Flask/cache_manager.py`：

```python
# 第7行左右，修改为：
self.stats = PopulationStatistics(use_memory_tables=True)
```

重启Flask应用：

```bash
cd GIS_Flask
python app.py
```

---

## ✅ 验证效果

访问 http://127.0.0.1:6667

- 人口分布图：加载时间应该从 3秒 降至 **0.01秒**
- 婚姻统计图：加载时间应该从 8秒 降至 **0.02秒**

**查看日志**：

```
🚀 使用内存表模式（MEMORY引擎）- 极速查询
✅ 获取省份人口数据成功，共 31 个省份（0.003秒）
✅ 获取省份婚姻数据成功，共 31 个省份（0.012秒）
```

---

## 🔄 可选：启动自动同步

```bash
# 后台持续运行，每30分钟自动同步
python auto_sync_daemon.py
```

---

## 🎉 完成！

现在您的GIS系统已经使用内存数据库，查询速度提升了 **100-700倍**！

---

## 📋 每日维护检查清单

- [ ] 检查守护进程是否运行: `ps aux | grep auto_sync_daemon`
- [ ] 检查最后同步时间: `SELECT * FROM memory_sync_metadata;`
- [ ] 每周备份一次: `python backup_memory_data.py`

---

## 💡 常见问题

**Q: 服务器重启后怎么办？**  
A: 重新运行 `python sync_to_memory.py` 即可恢复数据

**Q: 数据不是最新的？**  
A: 手动运行 `python sync_to_memory.py` 立即同步

**Q: 如何切回磁盘表？**  
A: 修改 `use_memory_tables=False` 并重启应用

---

**遇到问题？** 查看完整文档：`README.md`

