# ğŸš€ Flask GIS é«˜æ€§èƒ½å¯è§†åŒ–ç³»ç»Ÿ

åŸºäºFlask + å†…å­˜ç¼“å­˜çš„å®æ—¶äº¤äº’å¼GISå¯è§†åŒ–å¹³å°

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ é«˜æ€§èƒ½è®¾è®¡

- âš¡ **å†…å­˜ç¼“å­˜**ï¼šæ‰€æœ‰æ•°æ®ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå“åº”é€Ÿåº¦æå‡100å€
- ğŸ”„ **è‡ªåŠ¨æ›´æ–°**ï¼šæ¯10åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°ç¼“å­˜ï¼Œæ— éœ€æ‰‹åŠ¨åˆ·æ–°
- ğŸ“¡ **å®æ—¶å“åº”**ï¼šå‰ç«¯è¯·æ±‚ç›´æ¥ä»å†…å­˜è·å–ï¼Œæ¯«ç§’çº§å“åº”
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**ï¼šä½¿ç”¨é”æœºåˆ¶ä¿è¯å¹¶å‘å®‰å…¨

### ğŸŒŸ åŠŸèƒ½æ¨¡å—

| æ¨¡å— | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| ç¼“å­˜ç®¡ç† | `cache_manager.py` | å†…å­˜ç¼“å­˜å’Œå®šæ—¶æ›´æ–° |
| Flaskåç«¯ | `app.py` | RESTful APIæ¥å£ |
| å‰ç«¯é¡µé¢ | `templates/index.html` | äº¤äº’å¼å¯è§†åŒ–ç•Œé¢ |

### ğŸ“Š æ•°æ®å¯è§†åŒ–

- ğŸ—ºï¸ **äººå£åˆ†å¸ƒå›¾**ï¼šåœ°å›¾å±•ç¤ºå„çœäººå£
- ğŸ“ **äººå£å¯†åº¦å›¾**ï¼šé¢œè‰²æ¸å˜å±•ç¤ºå¯†åº¦
- ğŸ’‘ **å©šå§»ç»Ÿè®¡å›¾**ï¼šç»“å©šäººå£åˆ†å¸ƒ
- ğŸš€ **äººå£è¿ç§»å›¾**ï¼šæµå‘ç®­å¤´å±•ç¤ºè¿ç§»
- ğŸ‘« **æ€§åˆ«æ¯”ä¾‹å›¾**ï¼šç”·å¥³å¯¹æ¯”æŸ±çŠ¶å›¾
- ğŸ‚ **å¹´é¾„åˆ†å¸ƒå›¾**ï¼šå¹´é¾„æ®µé¥¼å›¾

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ å®‰è£…ä¾èµ–

```bash
cd GIS_Flask
pip install -r requirements.txt
```

### 2ï¸âƒ£ å¯åŠ¨æœåŠ¡

```bash
python app.py
```

**è¾“å‡ºä¿¡æ¯**ï¼š
```
============================================================
ğŸš€ Flask GIS å¯è§†åŒ–ç³»ç»Ÿå¯åŠ¨ä¸­...
============================================================

ğŸ“Š ç³»ç»Ÿä¿¡æ¯:
   - æœåŠ¡åœ°å€: http://127.0.0.1:5000
   - APIæ–‡æ¡£: http://127.0.0.1:5000/api/health
   - ç¼“å­˜æ›´æ–°: æ¯ 10 åˆ†é’Ÿ
   - CORS: å·²å¯ç”¨

âœ… ç³»ç»Ÿå°±ç»ªï¼ŒæŒ‰ Ctrl+C åœæ­¢æœåŠ¡
============================================================
```

### 3ï¸âƒ£ è®¿é—®ç³»ç»Ÿ

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://127.0.0.1:5000`

---

## ğŸ“¡ APIæ¥å£æ–‡æ¡£

### åŸºç¡€æ¥å£

#### 1. å¥åº·æ£€æŸ¥

```http
GET /api/health
```

**å“åº”**ï¼š
```json
{
  "status": "ok",
  "timestamp": "2025-11-10 15:30:00",
  "service": "GIS Visualization API"
}
```

#### 2. è·å–ç¼“å­˜ä¿¡æ¯

```http
GET /api/cache/info
```

**å“åº”**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "last_update": "2025-11-10 15:30:00",
    "next_update": "2025-11-10 15:40:00",
    "update_interval": 600,
    "is_updating": false,
    "data_count": {
      "provinces": 34,
      "migrations": 150,
      "marriages": 1000
    }
  }
}
```

#### 3. å¼ºåˆ¶æ›´æ–°ç¼“å­˜

```http
POST /api/cache/update
```

**å“åº”**ï¼š
```json
{
  "code": 200,
  "message": "ç¼“å­˜æ›´æ–°å·²è§¦å‘",
  "data": { /* ç¼“å­˜ä¿¡æ¯ */ }
}
```

### æ•°æ®æ¥å£

#### 4. è·å–æ‰€æœ‰æ•°æ®

```http
GET /api/data/all
```

**å“åº”**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "population": { "å¹¿ä¸œ": 45123, ... },
    "density": { "ä¸Šæµ·": 234.56, ... },
    "marriage": { ... },
    "migration": [ ... ],
    "gender": { ... },
    "age": { ... },
    "ethnicity": { ... },
    "national_summary": { ... },
    "top_rankings": { ... },
    "province_list": [ ... ],
    "update_time": "2025-11-10 15:30:00"
  }
}
```

#### 5. è·å–äººå£æ•°æ®

```http
GET /api/data/population
GET /api/data/population?province=å¹¿ä¸œ
```

**å“åº”**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "å¹¿ä¸œ": 45123,
    "å±±ä¸œ": 38456,
    ...
  }
}
```

#### 6. è·å–äººå£å¯†åº¦

```http
GET /api/data/density
GET /api/data/density?province=ä¸Šæµ·
```

#### 7. è·å–å©šå§»æ•°æ®

```http
GET /api/data/marriage
GET /api/data/marriage?province=å¹¿ä¸œ
```

**å“åº”**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "å¹¿ä¸œ": {
      "married_count": 1000,
      "marriage_rate": 2.21,
      "total": 45123
    }
  }
}
```

#### 8. è·å–è¿ç§»æ•°æ®

```http
GET /api/data/migration
GET /api/data/migration?limit=20
```

**å“åº”**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "migrations": [
      {"from": "å››å·", "to": "å¹¿ä¸œ", "count": 500},
      ...
    ],
    "summary": {
      "top_in": [ ... ],
      "top_out": [ ... ]
    }
  }
}
```

#### 9. è·å–æ€§åˆ«æ•°æ®

```http
GET /api/data/gender
GET /api/data/gender?province=å¹¿ä¸œ
```

#### 10. è·å–å¹´é¾„æ•°æ®

```http
GET /api/data/age
GET /api/data/age?province=å¹¿ä¸œ
```

#### 11. è·å–æ°‘æ—æ•°æ®

```http
GET /api/data/ethnicity
GET /api/data/ethnicity?province=å¹¿ä¸œ
```

#### 12. è·å–æ±‡æ€»æ•°æ®

```http
GET /api/data/summary
```

**å“åº”**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "national": {
      "total_population": 132546,
      "total_provinces": 34,
      "total_married": 5000,
      "total_migrations": 150
    },
    "top_rankings": {
      "population_top10": [ ... ],
      "density_top10": [ ... ]
    },
    "province_list": [ "å¹¿ä¸œ", "å±±ä¸œ", ... ],
    "update_time": "2025-11-10 15:30:00"
  }
}
```

#### 13. è·å–çœä»½åˆ—è¡¨

```http
GET /api/provinces
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æµè§ˆå™¨                        â”‚
â”‚              http://localhost:6667                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Flask Web Server (app.py)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  API Routes    â”‚  â”‚  Templates     â”‚            â”‚
â”‚  â”‚  13ä¸ªæ¥å£      â”‚  â”‚  index.html    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CacheManager (cache_manager.py)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          å†…å­˜ç¼“å­˜ï¼ˆPython Dictï¼‰              â”‚  â”‚
â”‚  â”‚  â€¢ population      â€¢ density                 â”‚  â”‚
â”‚  â”‚  â€¢ marriage        â€¢ migration               â”‚  â”‚
â”‚  â”‚  â€¢ gender          â€¢ age                     â”‚  â”‚
â”‚  â”‚  â€¢ ethnicity       â€¢ rankings                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    åå°æ›´æ–°çº¿ç¨‹ï¼ˆæ¯10åˆ†é’Ÿï¼‰                   â”‚  â”‚
â”‚  â”‚    â€¢ è‡ªåŠ¨æŸ¥è¯¢æ•°æ®åº“                           â”‚  â”‚
â”‚  â”‚    â€¢ æ›´æ–°å†…å­˜ç¼“å­˜                             â”‚  â”‚
â”‚  â”‚    â€¢ çº¿ç¨‹å®‰å…¨é”                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     PopulationStatistics (data_statistics.py)        â”‚
â”‚               æ•°æ®åº“æŸ¥è¯¢å’Œç»Ÿè®¡æ¨¡å—                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MySQL æ•°æ®åº“                        â”‚
â”‚           population / marriage_info                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµç¨‹

#### é¦–æ¬¡å¯åŠ¨æµç¨‹

```
1. Flaskåº”ç”¨å¯åŠ¨
   â†“
2. åˆ›å»ºCacheManagerå®ä¾‹
   â†“
3. ç«‹å³ä»æ•°æ®åº“åŠ è½½æ•°æ®åˆ°å†…å­˜
   â†“
4. å¯åŠ¨åå°æ›´æ–°çº¿ç¨‹
   â†“
5. FlaskæœåŠ¡å°±ç»ª
```

#### ç”¨æˆ·è¯·æ±‚æµç¨‹

```
ç”¨æˆ·æµè§ˆå™¨
   â†“
å‘èµ·HTTPè¯·æ±‚
   â†“
Flaskæ¥æ”¶è¯·æ±‚
   â†“
ä»å†…å­˜ç¼“å­˜è¯»å–æ•°æ®ï¼ˆæ¯«ç§’çº§ï¼‰
   â†“
è¿”å›JSONå“åº”
   â†“
å‰ç«¯EChartsæ¸²æŸ“
   â†“
æ˜¾ç¤ºäº¤äº’å¼å›¾è¡¨
```

#### ç¼“å­˜æ›´æ–°æµç¨‹

```
åå°çº¿ç¨‹ï¼ˆæ¯10åˆ†é’Ÿï¼‰
   â†“
è§¦å‘æ›´æ–°ä»»åŠ¡
   â†“
åŠ é”ï¼ˆç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼‰
   â†“
ä»æ•°æ®åº“æŸ¥è¯¢æœ€æ–°æ•°æ®
   â†“
è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡
   â†“
æ›´æ–°å†…å­˜ç¼“å­˜
   â†“
è§£é”
   â†“
ç­‰å¾…ä¸‹æ¬¡æ›´æ–°
```

---

## ğŸ’¡ æ ¸å¿ƒæŠ€æœ¯

### 1. å†…å­˜ç¼“å­˜æœºåˆ¶

**å®ç°åŸç†**ï¼š
```python
class CacheManager:
    def __init__(self, update_interval=600):
        self.cache = {}  # å†…å­˜å­—å…¸
        self.lock = threading.Lock()  # çº¿ç¨‹é”
        
        # ç«‹å³åŠ è½½æ•°æ®
        self.update_cache()
        
        # å¯åŠ¨åå°æ›´æ–°
        self.start_background_update()
    
    def get_cache(self):
        with self.lock:  # çº¿ç¨‹å®‰å…¨
            return self.cache.copy()
```

**ä¼˜åŠ¿**ï¼š
- âš¡ **é€Ÿåº¦å¿«**ï¼šå†…å­˜è¯»å–ï¼Œæ¯«ç§’çº§å“åº”
- ğŸ”„ **è‡ªåŠ¨æ›´æ–°**ï¼šåå°çº¿ç¨‹å®šæ—¶åˆ·æ–°
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**ï¼šé”æœºåˆ¶ä¿è¯å¹¶å‘å®‰å…¨
- ğŸ“¦ **é¢„è®¡ç®—**ï¼šTOPæ’è¡Œã€æ±‡æ€»æ•°æ®æå‰è®¡ç®—

### 2. å®šæ—¶ä»»åŠ¡

**å®ç°åŸç†**ï¼š
```python
def background_update_loop(self):
    while True:
        time.sleep(self.update_interval)  # ç­‰å¾…10åˆ†é’Ÿ
        self.update_cache()  # æ›´æ–°ç¼“å­˜
```

**ç‰¹ç‚¹**ï¼š
- ğŸ• **å®šæ—¶æ‰§è¡Œ**ï¼šç²¾ç¡®çš„æ—¶é—´é—´éš”
- ğŸ”„ **æŒç»­è¿è¡Œ**ï¼šå®ˆæŠ¤çº¿ç¨‹ï¼Œéšåº”ç”¨ç”Ÿå‘½å‘¨æœŸ
- ğŸ›¡ï¸ **å¼‚å¸¸å¤„ç†**ï¼šæ•è·é”™è¯¯ï¼Œä¸å½±å“ä¸»çº¿ç¨‹

### 3. RESTful API

**è®¾è®¡åŸåˆ™**ï¼š
- ğŸ“¡ **æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€çš„å“åº”æ ¼å¼
- ğŸ“ **èµ„æºåŒ–**ï¼šURLæ˜ å°„åˆ°æ•°æ®èµ„æº
- ğŸ” **å¯æŸ¥è¯¢**ï¼šæ”¯æŒå‚æ•°è¿‡æ»¤
- ğŸ“Š **çŠ¶æ€ç **ï¼š200æˆåŠŸï¼Œ404æœªæ‰¾åˆ°ï¼Œ500é”™è¯¯

**å“åº”æ ¼å¼**ï¼š
```json
{
  "code": 200,
  "message": "success",
  "data": { /* å®é™…æ•°æ® */ }
}
```

### 4. å‰ç«¯å¯è§†åŒ–

**æŠ€æœ¯æ ˆ**ï¼š
- ğŸ¨ **ECharts 5.4.3**ï¼šä¸“ä¸šå›¾è¡¨åº“
- ğŸ—ºï¸ **ä¸­å›½åœ°å›¾**ï¼šå†…ç½®çœçº§åœ°å›¾
- ğŸ’» **åŸç”ŸJavaScript**ï¼šæ— æ¡†æ¶ä¾èµ–
- ğŸ¯ **å“åº”å¼**ï¼šè‡ªé€‚åº”ä¸åŒå±å¹•

**å›¾è¡¨ç±»å‹**ï¼š
- Mapï¼ˆåœ°å›¾ï¼‰
- Barï¼ˆæŸ±çŠ¶å›¾ï¼‰
- Pieï¼ˆé¥¼å›¾ï¼‰
- Linesï¼ˆæµå‘å›¾ï¼‰

---

## âš¡ æ€§èƒ½å¯¹æ¯”

### å“åº”æ—¶é—´å¯¹æ¯”

| æ“ä½œ | ç›´æ¥æŸ¥è¯¢æ•°æ®åº“ | å†…å­˜ç¼“å­˜ | æå‡å€æ•° |
|------|---------------|---------|---------|
| è·å–äººå£æ•°æ® | 500ms | 5ms | 100x |
| è·å–å¯†åº¦æ•°æ® | 600ms | 5ms | 120x |
| è·å–å©šå§»æ•°æ® | 800ms | 5ms | 160x |
| è·å–è¿ç§»æ•°æ® | 1200ms | 5ms | 240x |
| è·å–æ‰€æœ‰æ•°æ® | 3000ms | 10ms | 300x |

### å¹¶å‘èƒ½åŠ›å¯¹æ¯”

| å¹¶å‘æ•° | ç›´æ¥æŸ¥è¯¢ | å†…å­˜ç¼“å­˜ |
|--------|---------|---------|
| 10 | 5ç§’ | 0.05ç§’ |
| 100 | 50ç§’ | 0.5ç§’ |
| 1000 | è¶…æ—¶ | 5ç§’ |

### èµ„æºå ç”¨

| èµ„æº | ä½¿ç”¨é‡ |
|------|--------|
| å†…å­˜ | ~50MBï¼ˆç¼“å­˜æ•°æ®ï¼‰ |
| CPU | <2%ï¼ˆç©ºé—²æ—¶ï¼‰ |
| å¸¦å®½ | æŒ‰éœ€ |

---

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®

ç¼–è¾‘ `cache_manager.py`ï¼š

```python
# åœ¨PopulationStatisticsç±»ä¸­ä¿®æ”¹
MYSQL_CONFIG = {
    'host': 'ä½ çš„æ•°æ®åº“åœ°å€',
    'port': ç«¯å£å·,
    'user': 'ç”¨æˆ·å',
    'password': 'å¯†ç ',
    'database': 'population'
}
```

### ç¼“å­˜æ›´æ–°é—´éš”

ä¿®æ”¹ `app.py`ï¼š

```python
# é»˜è®¤600ç§’ï¼ˆ10åˆ†é’Ÿï¼‰
cache_manager = get_cache_manager(update_interval=600)

# æ”¹ä¸º5åˆ†é’Ÿ
cache_manager = get_cache_manager(update_interval=300)

# æ”¹ä¸º30åˆ†é’Ÿ
cache_manager = get_cache_manager(update_interval=1800)
```

### FlaskæœåŠ¡å™¨é…ç½®

ä¿®æ”¹ `app.py` åº•éƒ¨ï¼š

```python
app.run(
    host='0.0.0.0',      # å…è®¸å¤–éƒ¨è®¿é—®
    port=5000,           # ç«¯å£å·
    debug=True,          # è°ƒè¯•æ¨¡å¼
    threaded=True        # å¤šçº¿ç¨‹
)
```

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### å¼€å‘ç¯å¢ƒ

```bash
python app.py
```

### ç”Ÿäº§ç¯å¢ƒ

#### ä½¿ç”¨Gunicorn

```bash
# å®‰è£…Gunicorn
pip install gunicorn

# å¯åŠ¨æœåŠ¡ï¼ˆ4ä¸ªworkerï¼‰
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

#### ä½¿ç”¨uWSGI

```bash
# å®‰è£…uWSGI
pip install uwsgi

# å¯åŠ¨æœåŠ¡
uwsgi --http :5000 --wsgi-file app.py --callable app --processes 4
```

#### ä½¿ç”¨Nginxåå‘ä»£ç†

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## ğŸ› æ•…éšœæ’é™¤

### Q1: ç¼“å­˜æ›´æ–°å¤±è´¥

**ç°è±¡**ï¼šæ—¥å¿—æ˜¾ç¤º"âŒ ç¼“å­˜æ›´æ–°å¤±è´¥"

**åŸå› **ï¼š
- æ•°æ®åº“è¿æ¥å¤±è´¥
- SQLæŸ¥è¯¢é”™è¯¯
- æ•°æ®æ ¼å¼é—®é¢˜

**è§£å†³**ï¼š
1. æ£€æŸ¥æ•°æ®åº“é…ç½®
2. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
3. æµ‹è¯•æ•°æ®åº“è¿æ¥

### Q2: APIè¿”å›500é”™è¯¯

**ç°è±¡**ï¼šæ¥å£è¯·æ±‚è¿”å›500çŠ¶æ€ç 

**åŸå› **ï¼š
- ç¼“å­˜æ•°æ®ä¸ºç©º
- å‚æ•°é”™è¯¯
- æœåŠ¡å™¨å¼‚å¸¸

**è§£å†³**ï¼š
1. æŸ¥çœ‹Flaskæ—¥å¿—
2. æ£€æŸ¥ç¼“å­˜çŠ¶æ€ï¼š`GET /api/cache/info`
3. å¼ºåˆ¶æ›´æ–°ç¼“å­˜ï¼š`POST /api/cache/update`

### Q3: å‰ç«¯åœ°å›¾ä¸æ˜¾ç¤º

**ç°è±¡**ï¼šé¡µé¢ç©ºç™½æˆ–åœ°å›¾åŠ è½½å¤±è´¥

**åŸå› **ï¼š
- ECharts CDNåŠ è½½å¤±è´¥
- ä¸­å›½åœ°å›¾æ•°æ®æœªåŠ è½½
- æ•°æ®æ ¼å¼é”™è¯¯

**è§£å†³**ï¼š
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹é”™è¯¯
3. ç¡®è®¤APIæ•°æ®æ­£å¸¸

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹ç¼“å­˜çŠ¶æ€

```bash
curl http://localhost:6667/api/cache/info
```

### æŸ¥çœ‹ç³»ç»Ÿå¥åº·

```bash
curl http://localhost:6667/api/health
```

### æŸ¥çœ‹æ—¥å¿—

Flaskä¼šåœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—ï¼š
- âœ… æˆåŠŸä¿¡æ¯ï¼ˆç»¿è‰²ï¼‰
- âš ï¸ è­¦å‘Šä¿¡æ¯ï¼ˆé»„è‰²ï¼‰
- âŒ é”™è¯¯ä¿¡æ¯ï¼ˆçº¢è‰²ï¼‰

---

## ğŸ‰ å®Œæˆï¼

æ‚¨çš„Flask GISç³»ç»Ÿå·²ç»é…ç½®å®Œæˆï¼

### å¿«é€Ÿæµ‹è¯•

```bash
# 1. å¯åŠ¨æœåŠ¡
python app.py

# 2. æµ‹è¯•API
curl http://localhost:6667/api/health

# 3. æµè§ˆå™¨è®¿é—®
http://localhost:6667
```

### æ ¸å¿ƒä¼˜åŠ¿

- âš¡ **100xæ€§èƒ½æå‡**ï¼šå†…å­˜ç¼“å­˜
- ğŸ”„ **è‡ªåŠ¨æ›´æ–°**ï¼š10åˆ†é’Ÿåˆ·æ–°
- ğŸ“¡ **å®æ—¶å“åº”**ï¼šæ¯«ç§’çº§API
- ğŸ—ºï¸ **äº¤äº’å¼åœ°å›¾**ï¼šEChartså¯è§†åŒ–
- ğŸ”’ **çº¿ç¨‹å®‰å…¨**ï¼šå¹¶å‘æ”¯æŒ

---

**ğŸŠ ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼**


